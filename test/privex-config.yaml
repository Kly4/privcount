# everybody needs these configs
global:
    epoch: 60 # (1 week = 604800 seconds) the safe time frame of stats collection for all stats
    clock_skew: 3 # (300s) # deal with clock skews and latency
    q: 2147483647 # ((2**31)-1) 2^31 - 1 happens to be a prime

# only the tally server needs these
tally_server:
    publish_delay: 23 # clock_skew + 20 seconds
    listen_port: 20001 # open port on which to listen for remote connections from TKSes
    key: 'keys/tally.key' # path to the key file
    cert: 'keys/tally.cert' # path to the certificate file
    results: 'results.txt' # path to file where the results will be stored

# only the tally key servers needs these
tally_key_server:
    start_delay: 3 # seconds
    listen_port: 20002 # open port on which to listen for remote connections from DCs
    key: 'keys/tks.key' # path to the key file
    cert: 'keys/tks.cert' # path to the certificate file
    tally_server_info: # where the tally server is located
        ip: 127.0.0.1
        port: 20001

# only the data collectors needs these
data_collector:
    start_delay: 5 # seconds
    register_delay: 8 # start_delay + 3 seconds
    listen_port: 20003 # local port on which to listen for local connections from Tor
    noise_weight: 1.0 # distribute noise among all machines / data collectors
    tally_server_info: # where the tally server is located
        ip: 127.0.0.1
        port: 20001
    tally_key_server_infos: # where the tally key servers are located
        -
            ip: 127.0.0.1
            port: 20002

    statistics:
        ################
        # exit traffic #
        ################
        -
            type: 'Streams_Count'
            sigma: 1.0
        -
            # at least one stream completed on the circuit
            type: 'Circuits_Count' # the key for this stat
            sigma: 1.0 # the sigma for the global noise we want for privacy for this stat
        -
            # no streams completed on the circuit
            type: 'InactiveCircuits_Count'
            sigma: 1.0
        -
            # completed streams per active circuit
            type: 'WebStreamsPerCircuit_Histogram' ## combine http and https together!
            sigma: 1.0
            bins: '0, 2, 4'
        -
            type: 'InteractiveStreamsPerCircuit_Histogram' ## combine irc and ssh too!
            sigma: 1.0
            bins: '0, 2, 4'
        -
            type: 'P2PStreamsPerCircuit_Histogram' ## bittorrent! classify port >= 10000 as BT.
            sigma: 1.0
            bins: '0, 2, 4'
        -
            type: 'OtherStreamsPerCircuit_Histogram' ## classify port < 10000 and no other class.
            sigma: 1.0
            bins: '0, 2, 4'
        -
            # time between create and destroy per completed stream
            type: 'WebStreamLifeTime_Histogram'
            sigma: 1.0
            bins: '0, 2, 4'
        -
            type: 'InteractiveStreamLifeTime_Histogram'
            sigma: 1.0
            bins: '0, 2, 4'
        -
            type: 'P2PStreamLifeTime_Histogram'
            sigma: 1.0
            bins: '0, 2, 4'
        -
            type: 'OtherStreamLifeTime_Histogram'
            sigma: 1.0
            bins: '0, 2, 4'
        -
            # bytes sent to server per completed stream
            type: 'BytesSentPerWebStream_Histogram'
            sigma: 1.0
            bins: '0, 2, 4'
        -
            type: 'BytesSentPerInteractiveStream_Histogram'
            sigma: 1.0
            bins: '0, 2, 4'
        -
            type: 'BytesSentPerP2PStream_Histogram'
            sigma: 1.0
            bins: '0, 2, 4'
        -
            type: 'BytesSentPerOtherStream_Histogram'
            sigma: 1.0
            bins: '0, 2, 4'
        -
            # bytes received from server per completed stream
            type: 'BytesReceivedPerWebStream_Histogram'
            sigma: 1.0
            bins: '0, 2, 4'
        -
            type: 'BytesReceivedPerInteractiveStream_Histogram'
            sigma: 1.0
            bins: '0, 2, 4'
        -
            type: 'BytesReceivedPerP2PStream_Histogram'
            sigma: 1.0
            bins: '0, 2, 4'
        -
            type: 'BytesReceivedPerOtherStream_Histogram'
            sigma: 1.0
            bins: '0, 2, 4'
        -
            # ratio of bytes sent to bytes received from server per completed stream
            type: 'BytesSentReceivedRatioPerWebStream_Histogram'
            sigma: 1.0
            bins: '0, 2, 4'
        -
            type: 'BytesSentReceivedRatioPerInteractiveStream_Histogram'
            sigma: 1.0
            bins: '0, 2, 4'
        -
            type: 'BytesSentReceivedRatioPerP2PStream_Histogram'
            sigma: 1.0
            bins: '0, 2, 4'
        -
            type: 'BytesSentReceivedRatioPerOtherStream_Histogram'
            sigma: 1.0
            bins: '0, 2, 4'
        #################
        # entry traffic #
        #################
        -
            # count over 10 mins, add to histogram counter after an additional 10 min wait period
            type: 'UniqueClientIPs_Histogram'
            sigma: 1.0
            bins: '0, 2, 4'
        -
            # count over same 10 min intervals as client ips
            # number of circuits with at least 8 cells transferred per client IP
            type: 'CircuitsPerClientIP_Histogram'
            sigma: 1.0
            bins: '0, 2, 4'
        -
            # number of circuits with less than 8 cells transferred
            type: 'InactiveCircuitsPerClientIP_Histogram'
            sigma: 1.0
            bins: '0, 2, 4'
        -
            # number of OR connections to clients
            # to help understand churn - do unique clients come and go or do they stick around long
            type: 'Connections_Count'
            sigma: 1.0
        -
            # circuit times
            type: 'CircuitLifeTime_Histogram'
            sigma: 1.0
            bins: '0, 2, 8, 10, 12, 20'
        -
            # cells sent 'in' to client per circuit on client OR connections
            type: 'CellsInPerCircuit_Histogram'
            sigma: 1.0
            bins: '0, 2, 4'
        -
            # cells sent 'out' from client per circuit on client OR connections
            type: 'CellsOutPerCircuit_Histogram'
            sigma: 1.0
            bins: '0, 2, 4'
        -
            # ratio of cells in to cells out per circuit on client OR connections
            type: 'CellsInOutRatioPerCircuit_Histogram'
            sigma: 1.0
            bins: '0, 2, 4'
