# everybody needs these configs
global:
    start_time: 1452111600 # 1452520800 : 2016-01-11 at 2pm UTC
    epoch: 60 # 604800 : (1 week = 604800 seconds) the safe time frame of stats collection for all stats
    clock_skew: 3 #300 # seconds - to deal with clock skews and latency
    q: 2147483647 # ((2**31)-1) 2^31 - 1 happens to be a prime

# only the tally server needs these
tally_server:
    listen_port: 20001 # open port on which to listen for remote connections from TKSes
    key: 'keys/ts.key' # path to the key file
    cert: 'keys/ts.cert' # path to the certificate file
    results: 'results.txt' # path to file where the results will be stored

# only the tally key servers needs these
tally_key_server:
    listen_port: 20002 # open port on which to listen for remote connections from DCs
    key: 'keys/tks.key' # path to the key file
    cert: 'keys/tks.cert' # path to the certificate file
    tally_server_info: # where the tally server is located
        ip: 127.0.0.1
        port: 20001

# only the data collectors needs these
data_collector:
    listen_port: 20003 # local port on which to listen for local connections from Tor
    noise_weight: 1.0 # distribute noise among all machines / data collectors
    tally_server_info: # where the tally server is located
        ip: 127.0.0.1
        port: 20001
    tally_key_server_infos: # where the tally key servers are located
        -
            ip: 127.0.0.1
            port: 20002

    statistics:
        ################
        # exit traffic #
        ################
        -
            type: 'Streams_Count'
            sigma: 1.0
        -
            # at least one stream completed on the circuit
            type: 'Circuits_Count' # the key for this stat
            sigma: 1.0 # the sigma for the global noise we want for privacy for this stat
        -
            # no streams completed on the circuit
            type: 'InactiveCircuits_Count'
            sigma: 1.0
        -
            # completed streams per active circuit
            type: 'WebStreamsPerCircuit_Histogram' ## combine http and https together!
            sigma: 1.0
            bins: '0, 1, 10, 20, 30, 50, 100'
        -
            type: 'InteractiveStreamsPerCircuit_Histogram' ## combine irc and ssh too!
            sigma: 1.0
            bins: '0, 1, 2, 4, 6, 8, 10'
        -
            type: 'P2PStreamsPerCircuit_Histogram' ## bittorrent! classify port >= 10000 as BT.
            sigma: 1.0
            bins: '0, 4, 8, 16, 32'
        -
            type: 'OtherStreamsPerCircuit_Histogram' ## classify port < 10000 and no other class.
            sigma: 1.0
            bins: '0, 4, 8, 16, 32'
        -
            # time in seconds between create and destroy per completed stream
            type: 'WebStreamLifeTime_Histogram'
            sigma: 1.0
            bins: '0, 1, 2, 3, 4, 8, 16, 32'
        -
            type: 'InteractiveStreamLifeTime_Histogram'
            sigma: 1.0
            bins: '0, 1, 60, 120, 300, 600, 1200'
        -
            type: 'P2PStreamLifeTime_Histogram'
            sigma: 1.0
            bins: '0, 1, 15, 30, 60, 300, 600, 1200'
        -
            type: 'OtherStreamLifeTime_Histogram'
            sigma: 1.0
            bins: '0, 1, 15, 30, 60, 300, 600, 1200'
        -
            # bytes sent to server per completed stream
            type: 'BytesSentPerWebStream_Histogram'
            sigma: 1.0
            bins: '0, 32768, 65536, 131072, 1048576, 2097152'
        -
            type: 'BytesSentPerInteractiveStream_Histogram'
            sigma: 1.0
            bins: '0, 131072, 262144, 524288, 1048576, 2097152'
        -
            type: 'BytesSentPerP2PStream_Histogram'
            sigma: 1.0
            bins: '0, 131072, 524288, 1048576, 2097152, 4194304'
        -
            type: 'BytesSentPerOtherStream_Histogram'
            sigma: 1.0
            bins: '0, 131072, 524288, 1048576, 2097152, 4194304'
        -
            # bytes received from server per completed stream
            type: 'BytesReceivedPerWebStream_Histogram'
            sigma: 1.0
            bins: '0, 131072, 262144, 524288, 1048576, 2097152'
        -
            type: 'BytesReceivedPerInteractiveStream_Histogram'
            sigma: 1.0
            bins: '0, 131072, 262144, 524288, 1048576, 2097152'
        -
            type: 'BytesReceivedPerP2PStream_Histogram'
            sigma: 1.0
            bins: '0, 131072, 524288, 1048576, 2097152, 4194304'
        -
            type: 'BytesReceivedPerOtherStream_Histogram'
            sigma: 1.0
            bins: '0, 131072, 524288, 1048576, 2097152, 4194304'
        -
            # ratio of bytes sent to bytes received from server per completed stream
            type: 'BytesSentReceivedRatioPerWebStream_Histogram'
            sigma: 1.0
            bins: '0.0, 0.1, 0.25, 0.5, 0.75, 0.9, 1.0'
        -
            type: 'BytesSentReceivedRatioPerInteractiveStream_Histogram'
            sigma: 1.0
            bins: '0.0, 0.1, 0.25, 0.5, 0.75, 0.9, 1.0'
        -
            type: 'BytesSentReceivedRatioPerP2PStream_Histogram'
            sigma: 1.0
            bins: '0.0, 0.1, 0.25, 0.5, 0.75, 0.9, 1.0'
        -
            type: 'BytesSentReceivedRatioPerOtherStream_Histogram'
            sigma: 1.0
            bins: '0.0, 0.1, 0.25, 0.5, 0.75, 0.9, 1.0'
        #################
        # entry traffic #
        #################
        -
            # count over 10 mins, add to histogram counter after an additional 10 min wait period
            type: 'UniqueClientIPs_Histogram'
            sigma: 1.0
            bins: '0, 100, 250, 500, 1000'
        -
            # count over same 10 min intervals as client ips
            # number of circuits with at least 8 cells transferred per client IP
            type: 'CircuitsPerClientIP_Histogram'
            sigma: 1.0
            bins: '0, 1, 5, 10, 20'
        -
            # number of circuits with less than 8 cells transferred<
            type: 'InactiveCircuitsPerClientIP_Histogram'
            sigma: 1.0
            bins: '0, 1, 5, 10, 20'
        -
            # number of OR connections to clients
            # to help understand churn - do unique clients come and go or do they stick around long
            type: 'Connections_Count'
            sigma: 1.0
        -
            # circuit times in seconds for active and inactive circuits
            type: 'CircuitLifeTime_Histogram'
            sigma: 1.0
            bins: '0, 120, 480, 600, 720, 1200'
        -
            # cells sent 'in' to client per active circuit on client OR connections
            type: 'CellsInPerCircuit_Histogram'
            sigma: 1.0
            bins: '0, 512, 1024, 2048, 4096'
        -
            # cells sent 'out' from client per active circuit on client OR connections
            type: 'CellsOutPerCircuit_Histogram'
            sigma: 1.0
            bins: '0, 64, 128, 256, 2048, 4096'
        -
            # ratio of cells in to cells out per active circuit on client OR connections
            type: 'CellsInOutRatioPerCircuit_Histogram'
            sigma: 1.0
            bins: '0.0, 0.1, 0.25, 0.5, 0.75, 0.9, 1.0'
